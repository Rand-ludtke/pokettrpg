{"version":3,"file":"panel-teamdropdown.js","names":["PSTeambuilder","exportPackedTeam","team","newFormat","sets","Teams","unpack","packedTeam","dex","Dex","forFormat","format","splitPrefix","buffer","delimiter","prefixOffset","arguments","length","undefined","delimIndex","indexOf","slice","splitLast","lastIndexOf","importTeamBackup","teams","lines","split","curTeam","curSet","shift","pop","_i2","line","trim","startsWith","pack","push","name","folder","key","iconCache","isBox","_ref","modid","endsWith","_this$splitPrefix","includes","PS","unpackLine","species","gender","moves","parseExportedTeamLine","dragStart","ev","_ev$currentTarget","href","currentTarget","getAttribute","byKey","dataTransfer","effectAllowed","setData","filename","$","replace","urlprefix","contents","downloadurl","encodeURIComponent","window","btoa","unescape","console","log","dragging","type","draggedTeam","TeamBox","props","unpackSpeciesOnly","map","pokemon","PSIcon","preact","h","className","button","value","noLink","draggable","onDragStart","onClick","TeamDropdownPanel","_PSRoomPanel","_this","_len","args","Array","_key","call","apply","concat","gen","setFormat","target","preventDefault","stopImmediatePropagation","forceUpdate","click","e","curTarget","tagName","parentElement","loadTeam","chooseParentValue","_inheritsLoose","_proto","prototype","getTeams","_this2","list","filter","render","_this3","room","parentElem","PSPanelWrapper","baseFormat","isFirstLoad","availableWidth","document","body","offsetWidth","width","teamBuckets","_i4","_teams2","teamList","baseGen","genList","_i6","_PS$teams$list2","hasOtherGens","sort","isEmpty","style","display","PSRoomPanel","id","routes","location","noURL","FormatDropdownPanel","_PSRoomPanel2","_this4","_len2","_key2","search","_curTarget","updateSearch","toggleGen","_proto2","_this5","formatsLoaded","BattleFormats","i","curGen","searchBar","placeholder","autocomplete","onInput","onChange","selectType","curFormat","toID","formats","Object","values","challengeShow","searchShow","tournamentShow","curSection","curColumnNum","curColumn","columns","searchID","_i8","column","section","unshift","Math","max","noResults","starredPrefs","prefs","starredformats","starred","keys","reverse","starredDone","test","addRoomType"],"sources":["../src/panel-teamdropdown.tsx"],"sourcesContent":["/**\n * Team Selector Panel\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license AGPLv3\n */\n\nimport { PS, type Team } from \"./client-main\";\nimport { PSIcon, PSPanelWrapper, PSRoomPanel } from \"./panels\";\nimport { Dex, toID, type ID } from \"./battle-dex\";\nimport { Teams } from \"./battle-teams\";\n\nexport class PSTeambuilder {\n\tstatic exportPackedTeam(team: Team, newFormat?: boolean) {\n\t\tconst sets = Teams.unpack(team.packedTeam);\n\t\tconst dex = Dex.forFormat(team.format);\n\t\treturn Teams.export(sets, dex, newFormat);\n\t}\n\tstatic splitPrefix(buffer: string, delimiter: string, prefixOffset = 0): [string, string] {\n\t\tconst delimIndex = buffer.indexOf(delimiter);\n\t\tif (delimIndex < 0) return ['', buffer];\n\t\treturn [buffer.slice(prefixOffset, delimIndex), buffer.slice(delimIndex + delimiter.length)];\n\t}\n\tstatic splitLast(buffer: string, delimiter: string): [string, string] {\n\t\tconst delimIndex = buffer.lastIndexOf(delimiter);\n\t\tif (delimIndex < 0) return [buffer, ''];\n\t\treturn [buffer.slice(0, delimIndex), buffer.slice(delimIndex + delimiter.length)];\n\t}\n\tstatic importTeamBackup(buffer: string): Team[] {\n\t\tconst teams: Team[] = [];\n\t\tconst lines = buffer.split(\"\\n\");\n\n\t\tlet curTeam: Team | null = null;\n\t\tlet sets: Dex.PokemonSet[] | null = null;\n\n\t\tlet curSet: Dex.PokemonSet | null = null;\n\n\t\twhile (lines.length && !lines[0]) lines.shift();\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\n\n\t\tfor (let line of lines) {\n\t\t\tline = line.trim();\n\t\t\tif (line === '' || line === '---') {\n\t\t\t\tcurSet = null;\n\t\t\t} else if (line.startsWith('===')) {\n\t\t\t\tif (curTeam) {\n\t\t\t\t\t// not the first team, store the previous team\n\t\t\t\t\tcurTeam.packedTeam = Teams.pack(sets);\n\t\t\t\t\tteams.push(curTeam);\n\t\t\t\t}\n\n\t\t\t\tcurTeam = {\n\t\t\t\t\tname: '',\n\t\t\t\t\tformat: '' as ID,\n\t\t\t\t\tpackedTeam: '',\n\t\t\t\t\tfolder: '',\n\t\t\t\t\tkey: '',\n\t\t\t\t\ticonCache: '',\n\t\t\t\t\tisBox: false,\n\t\t\t\t};\n\t\t\t\tsets = [];\n\n\t\t\t\tline = line.slice(3, -3).trim();\n\t\t\t\t[curTeam.format, line] = this.splitPrefix(line, ']', 1) as [ID, string];\n\t\t\t\t// Default to current mod's gen if no format specified\n\t\t\t\tif (!curTeam.format) curTeam.format = Dex.modid as ID;\n\t\t\t\telse if (!curTeam.format.startsWith('gen')) curTeam.format = `gen6${curTeam.format}` as ID;\n\t\t\t\t// Support '-box' suffix in header formats like [gen9-box]\n\t\t\t\tif ((curTeam.format as string).endsWith('-box')) {\n\t\t\t\t\tcurTeam.format = (curTeam.format as string).slice(0, -4) as ID;\n\t\t\t\t\tcurTeam.isBox = true;\n\t\t\t\t}\n\n\t\t\t\t[curTeam.folder, curTeam.name] = this.splitPrefix(line, '/');\n\t\t\t} else if (line.includes('|')) {\n\t\t\t\tif (curTeam) {\n\t\t\t\t\t// not the first team, store the previous team\n\t\t\t\t\tcurTeam.packedTeam = Teams.pack(sets);\n\t\t\t\t\tteams.push(curTeam);\n\t\t\t\t}\n\t\t\t\tcurTeam = null;\n\t\t\t\tcurSet = null;\n\t\t\t\tconst team = PS.teams.unpackLine(line);\n\t\t\t\tif (team) teams.push(team);\n\t\t\t} else if (!curSet) {\n\t\t\t\tif (!sets) continue; // corruption\n\t\t\t\tcurSet = {\n\t\t\t\t\tname: '', species: '', gender: '',\n\t\t\t\t\tmoves: [],\n\t\t\t\t};\n\t\t\t\tsets.push(curSet);\n\t\t\t\tTeams.parseExportedTeamLine(line, true, curSet);\n\t\t\t} else {\n\t\t\t\tTeams.parseExportedTeamLine(line, false, curSet);\n\t\t\t}\n\t\t}\n\t\tif (curTeam) {\n\t\t\tcurTeam.packedTeam = Teams.pack(sets);\n\t\t\tteams.push(curTeam);\n\t\t}\n\t\treturn teams;\n\t}\n\n\tstatic draggedTeam: Team | null = null;\n\tstatic dragStart(ev: DragEvent) {\n\t\tconst href = (ev.currentTarget as HTMLAnchorElement)?.getAttribute('href');\n\t\tconst team = href ? PS.teams.byKey[href.slice(5)] : null;\n\t\tif (!team) return;\n\n\t\tconst dataTransfer = ev.dataTransfer;\n\t\tif (dataTransfer) {\n\t\t\tdataTransfer.effectAllowed = 'copyMove';\n\t\t\tdataTransfer.setData(\"text/plain\", \"[Team] \" + team.name);\n\t\t\tlet filename = team.name;\n\t\t\tif (team.format) filename = '[' + team.format + '] ' + filename;\n\t\t\tfilename = $.trim(filename).replace(/[\\\\/]+/g, '') + '.txt';\n\t\t\tconst urlprefix = \"data:text/plain;base64,\";\n\t\t\tconst contents = PSTeambuilder.exportPackedTeam(team).replace(/\\n/g, '\\r\\n');\n\t\t\tconst downloadurl = \"text/plain:\" + filename + \":\" + urlprefix + encodeURIComponent(window.btoa(unescape(encodeURIComponent(contents))));\n\t\t\tconsole.log(downloadurl);\n\t\t\tdataTransfer.setData(\"DownloadURL\", downloadurl);\n\t\t}\n\n\t\tPS.dragging = { type: 'team', team, folder: null };\n\t\t// app.draggingRoom = this.id;\n\t\t// app.draggingLoc = parseInt(e.currentTarget.dataset.value, 10);\n\t\t// var elOffset = $(e.currentTarget).offset();\n\t\t// app.draggingOffsetX = e.originalEvent.pageX - elOffset.left;\n\t\t// app.draggingOffsetY = e.originalEvent.pageY - elOffset.top;\n\t\t// this.finalOffset = null;\n\t\t// setTimeout(function () {\n\t\t// \t$(e.currentTarget).parent().addClass('dragging');\n\t\t// }, 0);\n\t}\n}\n\nexport function TeamBox(props: {\n\tteam: Team | null,\n\tnoLink?: boolean,\n\tbutton?: boolean,\n\tonClick?: () => void,\n}) {\n\tconst team = props.team;\n\tlet contents;\n\tif (team) {\n\t\tteam.iconCache ||= team.packedTeam ? (\n\t\t\tTeams.unpackSpeciesOnly(team.packedTeam).map(\n\t\t\t\t// can't use <PSIcon>, weird interaction with iconCache\n\t\t\t\t// don't try this at home; I'm a trained professional\n\t\t\t\tpokemon => PSIcon({ pokemon })\n\t\t\t)\n\t\t) : (\n\t\t\t<em>(empty {team.isBox ? 'box' : 'team'})</em>\n\t\t);\n\t\tlet format = team.format as string;\n\t\tif (format.startsWith(Dex.modid)) format = format.slice(4);\n\t\tformat = (format ? `[${format}] ` : ``) + (team.folder ? `${team.folder}/` : ``);\n\t\tcontents = [\n\t\t\t<strong>{team.isBox && <i class=\"fa fa-archive\"></i>} {format && <span>{format}</span>}{team.name}</strong>,\n\t\t\t<small>{team.iconCache}</small>,\n\t\t];\n\t} else {\n\t\tcontents = [\n\t\t\t<em>Select a team</em>,\n\t\t];\n\t}\n\tconst className = `team${team?.isBox ? ' pc-box' : ''}`;\n\tif (props.button) {\n\t\treturn <button class={className} value={team ? team.key : ''}>\n\t\t\t{contents}\n\t\t</button>;\n\t}\n\tif (props.noLink) {\n\t\treturn <div class={className}>\n\t\t\t{contents}\n\t\t</div>;\n\t}\n\treturn <a\n\t\thref={`team-${team ? team.key : ''}`} class={className} draggable\n\t\tonDragStart={PSTeambuilder.dragStart} onClick={props.onClick}\n\t>\n\t\t{contents}\n\t</a>;\n}\n\n/**\n * Team selector popup\n */\n\nclass TeamDropdownPanel extends PSRoomPanel {\n\tstatic readonly id = 'teamdropdown';\n\tstatic readonly routes = ['teamdropdown'];\n\tstatic readonly location = 'semimodal-popup';\n\tstatic readonly noURL = true;\n\tgen = '';\n\tformat: string | null = null;\n\tgetTeams() {\n\t\tif (!this.format && !this.gen) return PS.teams.list;\n\t\treturn PS.teams.list.filter(team => {\n\t\t\tif (this.gen && !team.format.startsWith(this.gen)) return false;\n\t\t\tif (this.format && team.format !== this.format) return false;\n\t\t\treturn true;\n\t\t});\n\t}\n\tsetFormat = (ev: MouseEvent) => {\n\t\tconst target = ev.currentTarget as HTMLButtonElement;\n\t\tthis.format = (target.name === 'format' && target.value) || '';\n\t\tthis.gen = (target.name === 'gen' && target.value) || '';\n\t\tev.preventDefault();\n\t\tev.stopImmediatePropagation();\n\t\tthis.forceUpdate();\n\t};\n\tclick = (e: MouseEvent) => {\n\t\tlet curTarget = e.target as HTMLElement | null;\n\t\tlet target;\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\n\t\t\tif (curTarget.tagName === 'BUTTON') {\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\n\t\t\t}\n\t\t\tcurTarget = curTarget.parentElement;\n\t\t}\n\t\tif (!target) return;\n\n\t\tPS.teams.loadTeam(PS.teams.byKey[target.value], true);\n\t\tthis.chooseParentValue(target.value);\n\t};\n\toverride render() {\n\t\tconst room = this.props.room;\n\t\tif (!room.parentElem) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Error: You tried to open a team selector, but you have nothing to select a team for.</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\t\tconst baseFormat = room.parentElem.getAttribute('data-format') || Dex.modid;\n\t\tlet isFirstLoad = this.format === null;\n\t\tif (isFirstLoad) {\n\t\t\tthis.format = baseFormat;\n\t\t}\n\t\tlet teams = this.getTeams();\n\t\tif (!teams.length && this.format && isFirstLoad) {\n\t\t\tthis.gen = this.format.slice(0, 4);\n\t\t\tthis.format = '';\n\t\t\tteams = this.getTeams();\n\t\t}\n\t\tif (!teams.length && this.gen && isFirstLoad) {\n\t\t\tthis.gen = '';\n\t\t\tteams = this.getTeams();\n\t\t}\n\n\t\tlet availableWidth = document.body.offsetWidth;\n\t\tlet width = 307;\n\t\tif (availableWidth > 636) width = 613;\n\t\tif (availableWidth > 945) width = 919;\n\n\t\tlet teamBuckets: { [folder: string]: Team[] } = {};\n\t\tfor (const team of teams) {\n\t\t\tconst list = teamBuckets[team.folder] || (teamBuckets[team.folder] = []);\n\t\t\tlist.push(team);\n\t\t}\n\n\t\tlet teamList = [];\n\n\t\tconst baseGen = baseFormat.slice(0, 4);\n\t\tlet genList: string[] = [];\n\t\tfor (const team of PS.teams.list) {\n\t\t\tconst gen = team.format.slice(0, 4);\n\t\t\tif (gen && !genList.includes(gen)) genList.push(gen);\n\t\t}\n\t\tconst hasOtherGens = genList.length > 1 || genList[0] !== baseGen;\n\n\t\tteamList.push(<p>\n\t\t\t{baseFormat.length > 4 && (\n\t\t\t\t<button\n\t\t\t\t\tclass={'button' + (baseFormat === this.format ? ' disabled' : '')}\n\t\t\t\t\tonClick={this.setFormat} name=\"format\" value={baseFormat}\n\t\t\t\t>\n\t\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseFormat.slice(0, 4)}] {baseFormat.slice(4)}\n\t\t\t\t</button>\n\t\t\t)} {}\n\t\t\t<button\n\t\t\t\tclass={'button' + (baseGen === this.format ? ' disabled' : '')} onClick={this.setFormat} name=\"format\" value={baseGen}\n\t\t\t>\n\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseGen}] <em>(uncategorized)</em>\n\t\t\t</button> {}\n\t\t\t<button\n\t\t\t\tclass={'button' + (baseGen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={baseGen}\n\t\t\t>\n\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseGen}] <em>(all)</em>\n\t\t\t</button> {}\n\t\t\t{hasOtherGens && !this.gen && (\n\t\t\t\t<button class=\"button\" onClick={this.setFormat} name=\"gen\" value={baseGen}>Other gens</button>\n\t\t\t)}\n\t\t</p>);\n\n\t\tif (hasOtherGens && this.gen) {\n\t\t\tteamList.push(<h2>Other gens</h2>);\n\t\t\tteamList.push(<p>{genList.sort().map(gen => [\n\t\t\t\t<button class={'button' + (gen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={gen}>\n\t\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{gen}] <em>(all)</em>\n\t\t\t\t</button>,\n\t\t\t\t\" \",\n\t\t\t])}</p>);\n\t\t}\n\n\t\tlet isEmpty = true;\n\t\tfor (let folder in teamBuckets) {\n\t\t\tif (folder && (this.gen || this.format)) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open\" aria-hidden></i> {folder} + {}\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> {this.format || this.gen}\n\t\t\t\t</h2>);\n\t\t\t} else if (folder) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open\" aria-hidden></i> {folder}\n\t\t\t\t</h2>);\n\t\t\t} else if (this.gen || this.format) {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> {this.format || this.gen}\n\t\t\t\t</h2>);\n\t\t\t} else {\n\t\t\t\tteamList.push(<h2>\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> Teams not in any folders\n\t\t\t\t</h2>);\n\t\t\t}\n\t\t\tteamList.push(<ul class=\"teamdropdown\" onClick={this.click}>\n\t\t\t\t{teamBuckets[folder].map(team => <li key={team.key} style={{ display: 'inline-block' }}>\n\t\t\t\t\t<TeamBox team={team} button />\n\t\t\t\t</li>)}\n\t\t\t</ul>);\n\t\t\tisEmpty = false;\n\t\t}\n\n\t\treturn <PSPanelWrapper room={room} width={width}><div class=\"pad\">\n\t\t\t{teamList}\n\t\t\t{isEmpty && <p><em>No teams found</em></p>}\n\t\t</div></PSPanelWrapper>;\n\t}\n}\n\nexport interface FormatData {\n\tid: ID;\n\tname: string;\n\tteam?: 'preset' | null;\n\tsection: string;\n\tcolumn: number;\n\tsearchShow?: boolean;\n\tchallengeShow?: boolean;\n\ttournamentShow?: boolean;\n\trated: boolean;\n\tteambuilderLevel?: number | null;\n\tteambuilderFormat?: ID;\n\tbattleFormat?: string;\n\tisTeambuilderFormat: boolean;\n\teffectType: 'Format';\n}\n\ndeclare const BattleFormats: { [id: string]: FormatData };\n\nexport type SelectType = 'teambuilder' | 'challenge' | 'search' | 'tournament';\nclass FormatDropdownPanel extends PSRoomPanel {\n\tstatic readonly id = 'formatdropdown';\n\tstatic readonly routes = ['formatdropdown'];\n\tstatic readonly location = 'semimodal-popup';\n\tstatic readonly noURL = true;\n\tgen = '' as ID;\n\tformat: string | null = null;\n\tsearch = '';\n\tclick = (e: MouseEvent) => {\n\t\tlet curTarget = e.target as HTMLElement | null;\n\t\tlet target;\n\t\tif (curTarget?.tagName === 'I') return;\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\n\t\t\tif (curTarget.tagName === 'BUTTON') {\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\n\t\t\t}\n\t\t\tcurTarget = curTarget.parentElement;\n\t\t}\n\t\tif (!target) return;\n\n\t\tthis.chooseParentValue(target.value);\n\t};\n\tupdateSearch = (ev: Event) => {\n\t\tthis.search = (ev.currentTarget as HTMLInputElement).value;\n\t\tthis.forceUpdate();\n\t};\n\ttoggleGen = (ev: Event) => {\n\t\tconst target = ev.currentTarget as HTMLButtonElement;\n\t\tthis.gen = this.gen === target.value ? '' as ID : target.value as ID;\n\t\tthis.forceUpdate();\n\t};\n\toverride render() {\n\t\tconst room = this.props.room;\n\t\tif (!room.parentElem) {\n\t\t\treturn <PSPanelWrapper room={room}>\n\t\t\t\t<p>Error: You tried to open a format selector, but you have nothing to select a format for.</p>\n\t\t\t</PSPanelWrapper>;\n\t\t}\n\n\t\tlet formatsLoaded = !!window.BattleFormats;\n\t\tif (formatsLoaded) {\n\t\t\tformatsLoaded = false;\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\tfor (let i in window.BattleFormats) {\n\t\t\t\tformatsLoaded = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst curGen = (gen: string) => this.gen === gen ? ' cur' : '';\n\t\tconst searchBar = <div style=\"margin-bottom: 0.5em\">\n\t\t\t<input\n\t\t\t\ttype=\"search\" name=\"search\" placeholder=\"Search formats\" class=\"textbox autofocus\" autocomplete=\"off\"\n\t\t\t\tonInput={this.updateSearch} onChange={this.updateSearch}\n\t\t\t/> {}\n\t\t\t<button onClick={this.toggleGen} value=\"gen9\" class={`button button-first${curGen('gen9')}`}>Gen 9</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen8\" class={`button button-middle${curGen('gen8')}`}>8</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen7\" class={`button button-middle${curGen('gen7')}`}>7</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen6\" class={`button button-middle${curGen('gen6')}`}>6</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen5\" class={`button button-middle${curGen('gen5')}`}>5</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen4\" class={`button button-middle${curGen('gen4')}`}>4</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen3\" class={`button button-middle${curGen('gen3')}`}>3</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen2\" class={`button button-middle${curGen('gen2')}`}>2</button>\n\t\t\t<button onClick={this.toggleGen} value=\"gen1\" class={`button button-last${curGen('gen1')}`}>1</button>\n\t\t</div>;\n\t\tif (!formatsLoaded) {\n\t\t\treturn <PSPanelWrapper room={room}><div class=\"pad\">\n\t\t\t\t{searchBar}\n\t\t\t\t<p>Loading...</p>\n\t\t\t</div></PSPanelWrapper>;\n\t\t}\n\n\t\t/**\n\t\t * 'challenge' hides search-only formats, and 'search' hides challenge-only\n\t\t * formats. 'teambuilder' shows teambuilder formats (removing parentheses\n\t\t * from format names).\n\t\t */\n\t\tconst selectType: SelectType = (\n\t\t\troom.parentElem.getAttribute('data-selecttype') as any || 'challenge'\n\t\t);\n\t\tconst curFormat = toID((room.parentElem as HTMLButtonElement).value);\n\t\tconst formats = Object.values(BattleFormats).filter(format => {\n\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return false;\n\t\t\tif (selectType === 'search' && format.searchShow === false) return false;\n\t\t\tif (selectType === 'tournament' && format.tournamentShow === false) return false;\n\t\t\tif (selectType === 'teambuilder' && format.team) return false;\n\t\t\treturn true;\n\t\t});\n\n\t\tlet curSection = '';\n\t\tlet curColumnNum = 0;\n\t\tlet curColumn: ({ id: ID, name: string, section: string } | { id: null, section: string })[] = [];\n\t\tconst columns = [curColumn];\n\t\tconst searchID = toID(this.search);\n\t\tfor (const format of formats) {\n\t\t\tif (searchID && !toID(format.name).includes(searchID)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (this.gen && !format.id.startsWith(this.gen)) continue;\n\n\t\t\tif (format.column !== curColumnNum) {\n\t\t\t\tif (curColumn.length) {\n\t\t\t\t\tcurColumn = [];\n\t\t\t\t\tcolumns.push(curColumn);\n\t\t\t\t}\n\t\t\t\tcurColumnNum = format.column;\n\t\t\t}\n\t\t\tif (format.section !== curSection) {\n\t\t\t\tcurSection = format.section;\n\t\t\t\tif (curSection) {\n\t\t\t\t\tcurColumn.push({ id: null, section: curSection });\n\t\t\t\t}\n\t\t\t}\n\t\t\tcurColumn.push(format);\n\t\t}\n\t\tif (this.gen && selectType === 'teambuilder') {\n\t\t\tcolumns[0].unshift({\n\t\t\t\tid: this.gen,\n\t\t\t\tname: `[Gen ${this.gen.slice(3)}]`,\n\t\t\t\tsection: 'No Format',\n\t\t\t});\n\t\t}\n\n\t\tconst width = Math.max(columns.length, 2.1) * 225 + 30;\n\t\tconst noResults = curColumn.length === 0;\n\t\tconst starredPrefs = PS.prefs.starredformats || {};\n\t\t// reverse because the newest starred format should be the default\n\t\tconst starred = Object.keys(starredPrefs).filter(id => starredPrefs[id] === true).reverse();\n\t\tlet starredDone = false;\n\n\t\treturn <PSPanelWrapper room={room} width={width}><div class=\"pad\">\n\t\t\t{searchBar}\n\t\t\t{columns.map(column => (\n\t\t\t\t<ul class=\"options\" onClick={this.click}>\n\t\t\t\t\t{!starredDone && starred?.map((id, i) => {\n\t\t\t\t\t\tif (this.gen && !id.startsWith(this.gen)) return null;\n\t\t\t\t\t\tlet format = BattleFormats[id] as FormatData | undefined;\n\t\t\t\t\t\tif (/^gen[1-9]$/.test(id)) {\n\t\t\t\t\t\t\tformat ||= {\n\t\t\t\t\t\t\t\tid: id as ID,\n\t\t\t\t\t\t\t\tname: `[Gen ${id.slice(3)}]`,\n\t\t\t\t\t\t\t\tsection: 'No Format',\n\t\t\t\t\t\t\t\tchallengeShow: false,\n\t\t\t\t\t\t\t\tsearchShow: false,\n\t\t\t\t\t\t\t} as any;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!format) return null;\n\t\t\t\t\t\tif (i === starred.length - 1) starredDone = true;\n\t\t\t\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return null;\n\t\t\t\t\t\tif (selectType === 'search' && format.searchShow === false) return null;\n\t\t\t\t\t\tif (selectType === 'teambuilder' && format.team) return null;\n\t\t\t\t\t\treturn <li><button value={format.name} class={`option${curFormat === format.id ? ' cur' : ''}`}>\n\t\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\n\t\t\t\t\t\t\t{format.section === 'No Format' && <em> (uncategorized)</em>}\n\t\t\t\t\t\t\t<i class=\"star fa fa-star cur\" data-cmd={`/unstar ${format.id}`}></i>\n\t\t\t\t\t\t</button></li>;\n\t\t\t\t\t})}\n\t\t\t\t\t{column.map(format => {\n\t\t\t\t\t\t// do not include starred formats\n\t\t\t\t\t\tif (starred.includes(format.id || '')) return '';\n\t\t\t\t\t\tif (format.id) {\n\t\t\t\t\t\t\treturn <li><button\n\t\t\t\t\t\t\t\tvalue={format.name}\n\t\t\t\t\t\t\t\tclass={`option${curFormat === format.id ? ' cur' : ''}`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\n\t\t\t\t\t\t\t\t{format.section === 'No Format' && <em> (uncategorized)</em>}\n\t\t\t\t\t\t\t\t<i class=\"star fa fa-star-o\" data-cmd={`/star ${format.id}`}></i>\n\t\t\t\t\t\t\t</button></li>;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn <li><h3>{format.section}</h3></li>;\n\t\t\t\t\t\t}\n\t\t\t\t\t})}\n\t\t\t\t</ul>\n\t\t\t))}\n\t\t\t{noResults && <p>\n\t\t\t\t<em>No formats{!!searchID && ` matching \"${searchID}\"`} found</em>\n\t\t\t</p>}\n\t\t\t<div style=\"float: left\"></div>\n\t\t</div></PSPanelWrapper>;\n\t}\n}\n\nPS.addRoomType(TeamDropdownPanel, FormatDropdownPanel);\n"],"mappings":"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","ignoreList":[]}